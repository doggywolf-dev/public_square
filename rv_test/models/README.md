## Выбор базовой модели

В качестве базовой модели для дообучения была взята модель YOLO v8 nano. Архитектурно это одноэтапная модель сверточной сети, то есть она решает задачи классификации и регрессии одновременно и не содержит промежуточного этапа предсказания bounding box'а, в отличие от, например, R-CNN.

Выбор был сделан исходя из большой скорости работы таких моделей, позволяющей использовать их при обработке видео в реальном времени.

## Сбор данных
Сразу надо отметить, что при выборе обучающих данных была сделана фундаментальная ошибка, которая могла привести к переобучению и искуственному завышению метрик на валидационном и тестовом множестве. А именно, для обучения был взят набор изображений COCO с разметкой instances2017, как самый доступный. Не была проверена информация о том, что модель YOLOv8n.pt могла видеть его раньше, и это обнаружилось это уже в процессе обучения. Из-за ограниченного времени полного пересбора данных и переобучения не выполнялось. Проблема корректировалась в текущем процессе использованием аугментации, добавлением дополнительно размеченных изображений в обучающие наборы и проверкой результатов на полностью независимом тесте.

### Составление исходных обучающих наборов
Перед формированием наборов test, validate и train все доступные изображения с разметкой были собраны в одну кучу и перегруппированы заново. Это позволило увеличить размеры тестовых и валидационных выборок, которые для такого малого количества данных были недостаточны. Это делалось исходя из первоначального предположения, что модель YOLOv8n.pt ранее этого набора не видела.
Использованные скрипты находятся в директории ..\data_scripts\ 

### Дополнительно размеченные данные
Вручную были выбраны из интернета и размечены на roboflow.com и добавлены:
- в train 37 изображений фона и мусорных объектов, 35 изображений птиц,
- в val 21 изображение фона и мусорных объектов, 11 изображений птиц,

### Полностью ручной пересбор тестового множества
Для объективной проверки качества модели был собран вручную и размечен на roboflow.com набор, содержащий по 37 изображений птиц, самолетов, воздушных змеев и фона.

## Порядок обучения модели

Дообучение модели YOLOv8 производилось в три стадии

### 1. Быстрое базовое обучение на низком разрешении
10 эпох, Разрешение 320, без аугментации. Все гиперпараметры перечислены в конфиге train_stage_0.py

### 2. Обучение на низком разрешении с аугментацией данных
20 эпох, Разрешение 320, с базовой аугментацией. Гиперпараметры перечислены в конфиге train_stage_1.py

### 3. Обучение на высоком разрешении с усиленной аугментацией данных на расширенном наборе данных.
до 50 эпох, Разрешение 640, с усиленной аугментацией на расширенном ручной разметкой датасете. Гиперпараметры перечислены в конфиге train_stage_2.py

## Результаты на тестовом множестве.